<div class="dashboard-content">
  <div *ngIf="userRole === 'admin' || userRole === 'superadmin'" class="flex justify-between items-center mb-4">
    <div class="form-control">
      <label class="label cursor-pointer">
        <span class="label-text mr-2">{{ isAdminView ? 'Admin View' : 'Personal View' }}</span> 
        <input type="checkbox" class="toggle toggle-primary" [checked]="isAdminView" (change)="toggleDashboardView()">
      </label>
    </div>
  </div>

  <ng-container *ngIf="(userRole === 'admin' || userRole === 'superadmin') && isAdminView; else personalView">
    <!-- Admin Dashboard Content -->
    <div class="flex-1 mb-2">
      <a class="text-lg font-normal">You are currently viewing the Dashboard (Active Users Only).</a>
    </div>
    <div class="cards-container grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
      <div class="card bg-gradient-to-r from-orange-400 to-red-600 text-white p-6 rounded-lg shadow-lg">
        <h3 class="text-2xl font-bold">Female</h3>
        <p class="text-6xl font-extrabold">{{ totalFemale }}</p>
      </div>
      <div class="card bg-gradient-to-r from-orange-400 to-red-600 text-white p-6 rounded-lg shadow-lg">
        <h3 class="text-2xl font-bold">Male</h3>
        <p class="text-6xl font-extrabold">{{ totalMale }}</p>
      </div>
      <div class="card bg-gradient-to-r from-orange-400 to-red-600 text-white p-6 rounded-lg shadow-lg">
        <h3 class="text-2xl font-bold">Faculty</h3>
        <p class="text-6xl font-extrabold">{{ faculty }}</p>
      </div>
      <div class="card bg-gradient-to-r from-orange-400 to-red-600 text-white p-6 rounded-lg shadow-lg">
        <h3 class="text-2xl font-bold">Staff</h3>
        <p class="text-6xl font-extrabold">{{ staff }}</p>
      </div>
    </div>

    <div class="flex w-full flex-col">
      <div class="divider divider-neutral divider-end">Charts</div>
    </div>

    <!-- Charts Section -->
    <div class="charts-container grid grid-cols-1 md:grid-cols-2 gap-8 p-4">
      <div>
        <h2 class="text-2xl font-bold">Employment Types</h2>
        <canvas baseChart
                [data]="barChartData"
                [options]="barChartOptions"
                [legend]="barChartLegend"
                [type]="'bar'">
        </canvas>
      </div>

      <div>
        <h2 class="text-2xl font-bold">Instructor per Department</h2>
        <canvas baseChart
                [data]="pieChartData"
                [options]="pieChartOptions"
                [legend]="pieChartLegend"
                [type]="'pie'">
        </canvas>
      </div>
      <!-- <div *ngIf="ageGroupChartData && ageGroupChartData.labels && ageGroupChartData.labels.length > 0">
        <canvas baseChart
                [data]="ageGroupChartData"
                [options]="ageGroupChartOptions"
                [type]="'bar'">
        </canvas>
      </div> -->
    </div>
        <!-- Upcoming Birthdays Section -->
        <!--
        <div class="flex w-full flex-col mt-8">
          <div class="divider divider-neutral divider-end">Upcoming Birthdays</div>
        </div>
    
        <div class="upcoming-birthdays-container mt-4">
          <h2 class="text-2xl font-bold mb-4">Upcoming Birthdays</h2>
          <ul>
            <li *ngFor="let birthday of upcomingBirthdays">
              {{ birthday.FirstName }} {{ birthday.LastName }} - {{ birthday.DateOfBirth | date:'mediumDate' }}
            </li>
          </ul>
        </div>
        -->
  </ng-container>

  <ng-template #personalView>
    <!-- Personal Dashboard Content -->
    <div class="flex-1 mb-2">
      <a class="text-lg font-normal">Welcome to your Personal Dashboard</a>
    </div>
    <div class="cards-container grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
      <div class="card bg-gradient-to-r from-orange-400 to-red-600 text-white p-6 rounded-lg shadow-lg">
        <h3 class="text-2xl font-bold">Department</h3>
        <p class="text-2xl font-extrabold">{{ userDepartment }}</p>
      </div>
      <div class="card bg-gradient-to-r from-orange-400 to-red-600 text-white p-6 rounded-lg shadow-lg">
        <h3 class="text-2xl font-bold">Academic Rank</h3>
        <p class="text-2xl font-extrabold">{{ userAcademicRank }}</p>
      </div>
      <div class="card bg-gradient-to-r from-orange-400 to-red-600 text-white p-6 rounded-lg shadow-lg">
        <h3 class="text-2xl font-bold">Employment Type</h3>
        <p class="text-2xl font-extrabold">{{ userEmploymentType }}</p>
      </div>
    </div>

    <div class="flex w-full flex-col">
      <div class="divider divider-neutral divider-end">Your Information</div>
    </div>

    <!-- Profile Completion Section -->


    <!-- User-specific charts or information -->
    <div class="charts-container grid grid-cols-1 md:grid-cols-2 gap-8 p-4">
      <div>
        <h2 class="text-2xl font-bold">Your Activities</h2>
        <canvas baseChart
                [data]="userActivityChartData"
                [options]="userActivityChartOptions"
                [type]="'bar'">
        </canvas>
      </div>

      <div class="profile-completion-container p-4">
        <h2 class="text-2xl font-bold mb-4">Profile Completion</h2>
        <div class="flex items-center">
          <ngx-gauge
            [type]="gaugeType"
            [value]="gaugeValue"
            [append]="gaugeAppendText"
            [thick]="gaugeThick"
            cap="round"
            [size]="gaugeSize"
            foregroundColor="#e74c3c"
            [label]="''">
          </ngx-gauge>
          <div class="ml-4">
            <p class="font-bold text-lg">{{ getProfileMessage().title }}</p>
            <p class="text-sm text-gray-600">{{ getProfileMessage().description }}</p>
            <!-- Add PDS warning message -->
            <p *ngIf="gaugeValue < 100" class="mt-2 text-sm text-red-600 font-medium">
              Please complete your profile to generate PDS
            </p>
          </div>
        </div>
        <div class="tasks mt-4">
          <!-- First 3 Tasks (Always Visible) -->
          <div *ngFor="let task of (showAllTasks ? incompleteTasks : incompleteTasks.slice(0, 3))" 
               class="task-item flex items-center justify-between p-3 bg-white rounded-lg shadow-sm mb-2 hover:bg-gray-50 cursor-pointer"
               (click)="navigateToTask(task)">
            <span class="text-gray-700">{{ task }}</span>
            <span class="text-blue-500">â†’</span>
          </div>

          <!-- View All Button -->
          <button *ngIf="incompleteTasks.length > 3" 
                   class="view-all-button text-blue-500 hover:text-blue-700 mt-3"
                   (click)="toggleTasksView()">
            {{ showAllTasks ? 'Show less' : 'View all (' + incompleteTasks.length + ')' }}
          </button>
        </div>
      </div>
    </div>

    <!-- Trainings and Seminars Section -->
    <!--
    <div class="flex w-full flex-col mt-8">
      <div class="divider divider-neutral divider-end">Trainings and Seminars</div>
    </div>

    <div class="trainings-seminars-container mt-4">
      <h2 class="text-2xl font-bold mb-4">Recent Trainings and Seminars</h2>
      <table class="w-full">
        <thead>
          <tr>
            <th class="text-left">Title</th>
            <th class="text-left">Date</th>
            <th class="text-left">Type</th>
            <th class="text-left">Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of trainingsAndSeminars">
            <td>{{ item.title }}</td>
            <td>{{ item.date | date:'mediumDate' }}</td>
            <td>{{ item.type }}</td>
            <td>{{ item.status }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    -->
  </ng-template>

